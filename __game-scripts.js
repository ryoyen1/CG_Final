var Movement=pc.createScript("movement");Movement.prototype.initialize=function(){},Movement.prototype.update=function(t){this.app.keyboard.isPressed(pc.KEY_RIGHT)&&this.entity.translateLocal(.1,0,0),this.app.keyboard.isPressed(pc.KEY_LEFT)&&this.entity.translateLocal(-.1,0,0),this.app.keyboard.isPressed(pc.KEY_UP)&&this.entity.translateLocal(0,0,-.1),this.app.keyboard.isPressed(pc.KEY_DOWN)&&this.entity.translateLocal(0,0,.1)};var FirstPersonMovement=pc.createScript("firstPersonMovement");FirstPersonMovement.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),FirstPersonMovement.attributes.add("power",{type:"number",default:2500,description:"Adjusts the speed of player movement"}),FirstPersonMovement.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),FirstPersonMovement.attributes.add("sceneId",{type:"string",default:"0",title:"Scene ID load"}),FirstPersonMovement.attributes.add("bullet",{type:"entity"}),FirstPersonMovement.attributes.add("gunpower",{type:"number",default:1}),FirstPersonMovement.prototype.initialize=function(){target_count,this.app.timer_count;console.log("TEST"+timer_count),this.force=new pc.Vec3,this.eulers=new pc.Vec3;var e=this.app;e.mouse.on("mousemove",this._onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),e.mouse.on("mousedown",(function(){e.mouse.enablePointerLock(),this.shoot()}),this),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),window.removeEventListener("mousedown",this.onMouseDown,!1)})),this.entity.collision||console.error("First Person Movement script needs to have a 'collision' component"),this.entity.rigidbody&&this.entity.rigidbody.type===pc.BODYTYPE_DYNAMIC||console.error("First Person Movement script needs to have a DYNAMIC 'rigidbody' component")},FirstPersonMovement.prototype.update=function(e){(this.app.timer_count-=e,this.camera||this._createCamera(),console.log(this.app.timer_count),0===target_count||this.app.timer_count<0)&&(console.log("SHOULD WORK"),this.app.root.findByName("Root").destroy(),this.loadScene(this.sceneId,(function(){target_count=4})));FirstPersonMovement.prototype.loadScene=function(e,t){var o=e+".json";this.app.loadSceneSettings(e,(function(e){})),this.app.loadSceneHierarchy(o,(function(e,o){e?console.error(e):t(o)}))};var t=this.force,o=this.app,s=this.camera.forward,i=this.camera.right,r=0,n=0;(o.keyboard.isPressed(pc.KEY_A)||o.keyboard.isPressed(pc.KEY_Q))&&(r-=i.x,n-=i.z),o.keyboard.isPressed(pc.KEY_D)&&(r+=i.x,n+=i.z),o.keyboard.isPressed(pc.KEY_W)&&(r+=s.x,n+=s.z),o.keyboard.isPressed(pc.KEY_S)&&(r-=s.x,n-=s.z),0!==r&&0!==n&&(t.set(r,0,n).normalize().scale(this.power),this.entity.rigidbody.applyForce(t)),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)},FirstPersonMovement.prototype.shoot=function(e){console.log("Shooting");var t=this.bullet.clone();this.app.root.addChild(t);this.entity;var o=this.app.root.findByName("colt");this.force=new pc.Vec3,this.force.copy(o.forward),this.force.scale(this.gunpower);var s=o.getPosition();o.forward;t.setPosition(s),t.enabled=!0,t.rigidbody.applyImpulse(this.force)},FirstPersonMovement.prototype._onMouseMove=function(e){(pc.Mouse.isPointerLocked()||e.buttons[0])&&(this.eulers.x-=this.lookSpeed*e.dx,this.eulers.y-=this.lookSpeed*e.dy)},FirstPersonMovement.prototype._createCamera=function(){this.camera=new pc.Entity,this.camera.setName("First Person Camera"),this.camera.addComponent("camera"),this.entity.addChild(this.camera),this.camera.translateLocal(0,.5,0)};var Bullet=pc.createScript("bullet");Bullet.attributes.add("bulletobj",{type:"entity"}),Bullet.prototype.initialize=function(){this.entities=[]},Bullet.prototype.update=function(t){for(i=0;i<this.entities.length;i++)this.entities[i].translateLocal(0,1*t,0);this.app.mouse.on("mousedown")&&this.cloning()},Bullet.prototype.cloning=function(){var t=this.entity.getPosition(),i=this.bulletobj.clone();this.app.root.addChild(i),i.setPosition(t),this.entities.push(i),console.log(t)};var Shoot=pc.createScript("shoot");Shoot.attributes.add("power",{type:"number",default:1}),Shoot.attributes.add("bullet",{type:"entity"}),Shoot.prototype.initialize=function(){},Shoot.prototype.update=function(t){this.app.keyboard.wasPressed(pc.KEY_SPACE)&&this.shoot()},Shoot.prototype.shoot=function(t){var o=this.bullet.clone();this.app.root.addChild(o);var e=this.entity;this.force=new pc.Vec3,this.force.copy(e.forward),this.force.scale(this.power);var i=e.getPosition(),a=e.forward;i.add(a.scale(5+.01*e.rigidbody.linearVelocity.length())),o.setPosition(i);var r=e.getRotation();o.setRotation(r),o.rotateLocal(90,0,0),o.enabled=!0,o.rigidbody.applyImpulse(this.force)},Shoot.prototype.swap=function(t){};var Target=pc.createScript("target"),destroy_state=!1,target_count=4;Target.attributes.add("target_count",{type:"number",default:4}),Target.attributes.add("collide",{type:"number",default:1}),Target.prototype.setState=function(t){Target.states;this.state=t},Target.prototype.initialize=function(){this.collide,this.target_count=4;this.entity.collision.on("contact",this.onContact,this)},Target.prototype.update=function(t){this.collide,this.app.root.findByName("target"),this.app.root.findByName("player");var e=this.destroy_state;!0===this.destroy_state?(this.destroys(),this.destroy_state=!1,console.log(e)):console.log()},Target.prototype.onContact=function(t){this.collide;t.other.rigidbody&&t.other.tags.has("bullet")&&(this.destroys(),target_count--,console.log(target_count),console.log(destroy_state))},Target.prototype.destroys=function(t){var e=this.entity;this.target_count;this.destroy_state=!0,this.setState("destroyed"),e.translateLocal(0,0,0),console.log("you hit me"),e.destroy()};var Startbutton=pc.createScript("startbutton");Startbutton.attributes.add("sceneId",{type:"string",default:"0",title:"Scene ID load"}),Startbutton.prototype.initialize=function(){this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this)},Startbutton.prototype.onPress=function(t){this.app.root.findByName("Root").destroy(),this.loadScene(this.sceneId,(function(){}))},Startbutton.prototype.update=function(t){},Startbutton.prototype.loadScene=function(t,e){var n=t+".json";this.app.loadSceneHierarchy(n,(function(t,n){t?console.error(t):e(n)}))};var TargetLeft=pc.createScript("targetLeft");TargetLeft.attributes.add("targetcounts",{type:"number",title:"target"}),TargetLeft.prototype.initialize=function(){this.entity;var t=target_count;console.log(t)},TargetLeft.prototype.update=function(t){var e=target_count;this.app.root.findByName("TargetUI").element.text=e+" / 4"};var Targetcounts=pc.createScript("targetcounts");Targetcounts.prototype.initialize=function(){var t=this.app.targetcounts=4;console.log("Targetcounts js"+t)},Targetcounts.prototype.update=function(t){};var Menu=pc.createScript("menu");Menu.prototype.initialize=function(){this.app.mouse.on("mousemove",this._onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this)},Menu.prototype.update=function(o){};var Timer=pc.createScript("timer"),timer_count=30;Timer.prototype.initialize=function(){var t=this.app.timer_count=30,e=(this.entity,t);console.log(e)},Timer.prototype.update=function(t){var e=timer_count;timer_count-=t,Math.floor(e),this.app.root.findByName("TimerUI").element.text="Time left : "+Math.floor(e)};